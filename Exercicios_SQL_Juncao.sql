CREATE TABLE CLIENTE(
CPF INT PRIMARY KEY,
NOME varchar(60),
DTNASC int
);

CREATE TABLE VEICULO(
PLACA VARCHAR(8) PRIMARY KEY,
MODELO_CODMOD INT,
CLIENTE_CPF INT,
COR VARCHAR(20),
ANO INT
);

CREATE TABLE MODELO(
CODMOD INT PRIMARY KEY,
DESC_2 VARCHAR(40)
);

CREATE TABLE PATIO(
NUM INT PRIMARY KEY,
ENDER VARCHAR(40),
CAPACIDADE INT
);

CREATE TABLE ESTACIONAMENTO(
COD INT PRIMARY KEY,
PATIO_NUM INT,
VEICULO_PLACA VARCHAR(8),
DTENTRADA VARCHAR(10),
DTSAIDA VARCHAR(10),
HSENTRADA VARCHAR(10),
HSSAIDA VARCHAR(10)
);

ALTER TABLE VEICULO ADD CONSTRAINT FK_COD_MODELO
FOREIGN KEY (MODELO_CODMOD) REFERENCES MODELO(CODMOD) ON DELETE RESTRICT;

ALTER TABLE VEICULO ADD CONSTRAINT FK_CLIENTE_CPF
FOREIGN KEY (CLIENTE_CPF) REFERENCES CLIENTE(CPF) ON DELETE RESTRICT;

ALTER TABLE ESTACIONAMENTO ADD CONSTRAINT FK_PATIO_NUM
FOREIGN KEY (PATIO_NUM) REFERENCES PATIO(NUM) ON DELETE RESTRICT;

ALTER TABLE ESTACIONAMENTO ADD CONSTRAINT FK_VEICULO_PLACA
FOREIGN KEY (VEICULO_PLACA) REFERENCES VEICULO(PLACA) ON DELETE RESTRICT;

INSERT INTO CLIENTE VALUES
(01777744401, "DOUGLAS", 170487),
(00100233344, "JOSÉ", 200575),
(00204898778, "MARIA", 210689),
(01777044407, "RODRIGO", 170487);

INSERT INTO MODELO VALUES
(1, "CHEVROLET CLASSIC"),
(2, "CHEVROLET CORSA"),
(3, "CHEVROLET CRUZE"),
(4, "CHEVROLET CLASSIC");

INSERT INTO VEICULO VALUES
("PAS-2002", 1, 01777744401, "PRETO", 2011),
("JJJ-2020", 2, 00100233344, "AZUL", 1998),
("JEG-1010", 3, 00204898778, "VERDE", 2019),
("CSA-2022", 4, 01777044407, "VERDE", 2012);

INSERT INTO PATIO VALUES
(1, "CAMPINA", 40),
(2, "SCHARLAU", 40),
(3, "RIO DOS SINOS", 40);

INSERT INTO ESTACIONAMENTO VALUES
(1, 1, "PAS-2002", "220922", "220922", "12:00", "15:00"),
(2, 2, "CSA-2022", "210922", "210922", "09:45", "12:30"),
(3, 1, "JEG-1010", "200922", "200922", "07:25", "17:00"),
(4, 1, "JEG-1010", "230922", "230922", "07:20", "16:45"),
(5, 3, "JJJ-2020", "240922", "240922", "16:15", "21:35");

-- A)
SELECT NOME, PLACA 
FROM CLIENTE C
INNER JOIN VEICULO V
ON V.CLIENTE_CPF = C.CPF;

-- B)
SELECT CPF, NOME
FROM CLIENTE C
INNER JOIN VEICULO V
ON C.CPF = V.CLIENTE_CPF AND V.PLACA = "JJJ-2020";

-- C)
SELECT PLACA, COR
FROM VEICULO V 
INNER JOIN ESTACIONAMENTO E 
ON E.VEICULO_PLACA = V.PLACA AND E.COD = 1;

-- D)
SELECT PLACA, ANO
FROM VEICULO V
INNER JOIN ESTACIONAMENTO E 
ON E.VEICULO_PLACA = V.PLACA AND E.COD = 1;

-- E)
SELECT PLACA, ANO, DESC_2
FROM VEICULO V 
INNER JOIN MODELO M 
ON V.MODELO_CODMOD = M.CODMOD AND V.ANO >= 2000;

-- F)
SELECT ENDER, DTENTRADA, DTSAIDA
FROM PATIO P
INNER JOIN ESTACIONAMENTO E 
ON E.PATIO_NUM = P.NUM AND E.VEICULO_PLACA = "JEG-1010";

-- G)
SELECT PLACA
FROM VEICULO V 
INNER JOIN ESTACIONAMENTO E 
ON V.PLACA = E.VEICULO_PLACA AND V.COR = "VERDE";

-- H)
SELECT NOME, CPF, DTNASC --USEI A FK DO VEICULO, PODE? E É PRA DEIXAR COMO NA LETRA J?
FROM CLIENTE C
INNER JOIN VEICULO V 
ON V.CLIENTE_CPF = C.CPF AND V.MODELO_CODMOD = 1;

-- I)
SELECT PLACA, HSENTRADA, HSSAIDA
FROM VEICULO V 
INNER JOIN ESTACIONAMENTO E 
ON E.VEICULO_PLACA = V.PLACA AND V.COR = "VERDE";

-- J)
SELECT * FROM ESTACIONAMENTO E
INNER JOIN VEICULO V 
ON V.PLACA = E.VEICULO_PLACA AND V.PLACA = "JJJ-2020";

-- K)
SELECT NOME
FROM CLIENTE C 
INNER JOIN VEICULO V 
ON V.CLIENTE_CPF = C.CPF
INNER JOIN ESTACIONAMENTO E
ON E.VEICULO_PLACA = V.PLACA AND E.COD = 2;

-- L)
SELECT CPF
FROM CLIENTE C 
INNER JOIN VEICULO V 
ON V.CLIENTE_CPF = C.CPF
INNER JOIN ESTACIONAMENTO E
ON E.VEICULO_PLACA = V.PLACA AND E.COD = 3;

-- M)
SELECT DESC_2 AS `DESCRIÇÃO`
FROM MODELO M 
INNER JOIN VEICULO V 
ON V.MODELO_CODMOD = M.CODMOD
INNER JOIN ESTACIONAMENTO E 
ON E.VEICULO_PLACA = V.PLACA AND E.COD = 2;

-- N)
SELECT PLACA, NOME, DESC_2
FROM VEICULO V 
INNER JOIN CLIENTE C 
ON C.CPF = V.CLIENTE_CPF
INNER JOIN MODELO M 
ON V.MODELO_CODMOD = M.CODMOD
ORDER BY C.NOME ASC;



